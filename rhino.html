<!DOCTYPE html>
<html lang='en'>
<head>
  <meta charset='UTF-8'>
  <meta name='viewport' content='width=device-width, initial-scale=1.0'>
  <title>EnneadTab-For-Rhino Knowledge - EnneadTabWiki</title>
  <link rel='stylesheet' href='style.css'>
</head>
<body>

<div class='wiki-header-row'>
  <h1 class='hero-title'>EnneadTab-For-Rhino Wiki</h1>
  <a class='return-home-btn' href='index.html'>Return to Home</a>
                </div>
<div class='knowledge-container'>
  <button class='sidebar-toggle' id='sidebarToggle' aria-label='Toggle Sidebar'>&#9776;</button>
        <div class='sidebar' id='sidebar'><a href='#Enneaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaad_menu' style='color:inherit;text-decoration:none;display:block;margin-bottom:1.2rem;font-size:1.1rem;'>Enneaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaad.menu</a></div>
  <div style='flex:1;min-width:0;'>
    <div class='search-bar sticky'>
      <input type='text' id='searchInput' placeholder='Search tools...'>
      <button class='clear-btn' id='clearSearch' aria-label='Clear'>&times;</button>
            </div>
    <section class='tab-section' id='Enneaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaad_menu'><div class='tab-title'>Enneaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaad.menu</div><div class='tool-grid'>
  <article class='tool-card' data-alias='install enneadtab' data-doc='install enneadtab' data-tab='Enneaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaad.menu'>
    <div class='tool-content'>
      <div class='tool-icon-column'><img src='assets/lib_EnneadTab_RHINO_Enneaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaad_menu_Installation_button_icon.png' class='tool-icon' alt='Install EnneadTab icon'></div>
      <div class='tool-text-column'>
        <header class='tool-header'>
          <h3 class='tool-title'>Install EnneadTab</h3>
                                </header>
        <p class='tool-description'>Install EnneadTab</p>
                            </div>
                        </div>
    
                    </article>
                
  <article class='tool-card' data-alias='uninstalloldversion' data-doc='uninstall any version of enneadtab. do this only if you have old enneadtab for rhino on your machine.

' data-tab='Enneaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaad.menu'>
    <div class='tool-content'>
      <div class='tool-icon-column'><div class='tool-icon-placeholder'></div></div>
      <div class='tool-text-column'>
        <header class='tool-header'>
          <h3 class='tool-title'>UninstallOldVersion</h3>
                                </header>
        <p class='tool-description'>Uninstall any version of EnneadTab. Do this only if you have old enneadtab for rhino on your machine.

</p>
                            </div>
                        </div>
    
                    </article>
                </div></section>
<div id='search-results-container' style='display: none;'>
  <div class='search-results-header'>
    <h2>Search Results</h2>
    <span id='search-results-count'></span>
  </div>
  <div class='tool-grid' id='search-results-grid'></div>
</div>

    </div>
        </div>
<button class='return-top-btn' id='returnTopBtn' title='Return to Top'>&uarr;</button>
    <script>
// Fuzzy search function with scoring - more forgiving search
function fuzzySearch(text, query) {
    if (!query) return { match: true, score: 0 };
    
    const textLower = text.toLowerCase();
    const queryLower = query.toLowerCase();
    
    let score = 0;
    
    // Direct substring match (highest priority - 100 points)
    if (textLower.includes(queryLower)) {
        score += 100;
        // Bonus for exact start match (50 points)
        if (textLower.startsWith(queryLower)) {
            score += 50;
        }
        // Bonus for exact end match (25 points)
        if (textLower.endsWith(queryLower)) {
            score += 25;
        }
    }
    
    // Word boundary matches
    const textWords = textLower.split(/\s+/);
    const queryWords = queryLower.split(/\s+/);
    
    let allWordsFound = true;
    let wordMatchScore = 0;
    
    for (const queryWord of queryWords) {
        let found = false;
        let bestWordScore = 0;
        
        for (const textWord of textWords) {
            let wordScore = 0;
            
            // Exact word match (40 points)
            if (textWord === queryWord) {
                wordScore = 40;
            }
            // Word starts with query (30 points)
            else if (textWord.startsWith(queryWord)) {
                wordScore = 30;
            }
            // Word contains query (20 points)
            else if (textWord.includes(queryWord)) {
                wordScore = 20;
            }
            // Query contains word (10 points)
            else if (queryWord.includes(textWord)) {
                wordScore = 10;
            }
            
            if (wordScore > 0) {
                found = true;
                bestWordScore = Math.max(bestWordScore, wordScore);
            }
        }
        
        if (found) {
            wordMatchScore += bestWordScore;
        } else {
            allWordsFound = false;
        }
    }
    
    if (allWordsFound) {
        score += wordMatchScore;
        // Bonus for matching all query words (25 points)
        score += 25;
    }
    
    // Length penalty - shorter matches get bonus (up to 20 points)
    const lengthRatio = Math.min(queryLower.length / textLower.length, 1);
    score += Math.floor(lengthRatio * 20);
    
    return { match: score > 0, score: score };
}

// Sidebar toggle for mobile
const sidebar = document.getElementById('sidebar');
const sidebarToggle = document.getElementById('sidebarToggle');
if (sidebar && sidebarToggle) {
  sidebarToggle.addEventListener('click', function() {
    sidebar.classList.toggle('open');
  });
}

// Enhanced search functionality with fuzzy search and tab hiding
const searchInput = document.getElementById('searchInput');
const clearBtn = document.getElementById('clearSearch');
if (searchInput && clearBtn) {
  clearBtn.addEventListener('click', function() {
    searchInput.value = '';
    searchInput.dispatchEvent(new Event('input'));
  });
  
  searchInput.addEventListener('input', function() {
    const query = this.value.trim();
    
    // Get search results container
    const searchContainer = document.getElementById('search-results-container');
    const searchGrid = document.getElementById('search-results-grid');
    const searchCount = document.getElementById('search-results-count');
    
    // Get all tab sections
    const tabSections = document.querySelectorAll('.tab-section');
    
    if (query === '') {
      // Clear search - show all sections normally
      searchContainer.style.display = 'none';
      tabSections.forEach(section => {
        section.style.display = '';
        const toolCards = section.querySelectorAll('.tool-card');
        toolCards.forEach(card => {
          card.style.display = '';
        });
      });
      return;
    }
    
    // Collect all matching cards with scores for unified ranking
    const allCardScores = [];
    
    tabSections.forEach(section => {
      const toolCards = section.querySelectorAll('.tool-card');
      
      toolCards.forEach(card => {
        const alias = card.getAttribute('data-alias') || '';
        const doc = card.getAttribute('data-doc') || '';
        const tabName = card.getAttribute('data-tab') || 'Unknown';
        
        // Use fuzzy search for both alias and description
        const aliasResult = fuzzySearch(alias, query);
        const docResult = fuzzySearch(doc, query);
        
        if (aliasResult.match || docResult.match) {
          // Calculate total score (alias matches get higher weight)
          let totalScore = (aliasResult.score * 2) + docResult.score;
          
          // Apply custom tab/panel ranking based on platform
          const platform = 'rhino';
          
          if (platform === 'rhino') {
            // For Rhino: rank Tailor.tab as later half
            if (tabName.toLowerCase().includes('tailor')) {
              totalScore -= 1000; // Push to later half
            }
          } else if (platform === 'revit') {
            // For Revit: rank Proj.xxx, Tailor, Personal, and No Tab as later half
            const lowerTabName = tabName.toLowerCase();
            if (lowerTabName.startsWith('proj.') || 
                lowerTabName.includes('tailor') || 
                lowerTabName.includes('personal') || 
                lowerTabName.includes('no tab')) {
              totalScore -= 1000; // Push to later half
            }
          }
          
          allCardScores.push({ 
            card: card, 
            score: totalScore,
            tabName: tabName,
            alias: alias,
            doc: doc
          });
        }
      });
      
      // Hide all tab sections during search
      section.style.display = 'none';
    });
    
    // Sort all results by score (highest first)
    allCardScores.sort((a, b) => b.score - a.score);
    
    // Clear search results grid
    if (searchGrid) {
      searchGrid.innerHTML = '';
    }
    
    // Add sorted results to search container
    if (allCardScores.length > 0) {
      searchContainer.style.display = 'block';
      
      // Update results count
      if (searchCount) {
        searchCount.textContent = `(${allCardScores.length} results)`;
      }
      
      // Add tab labels and sorted cards
      let currentTab = '';
      allCardScores.forEach(item => {
        // Add tab separator if tab changes
        if (item.tabName !== currentTab) {
          currentTab = item.tabName;
          const tabLabel = document.createElement('div');
          tabLabel.className = 'search-tab-label';
          tabLabel.innerHTML = `<h3>${currentTab}</h3>`;
          searchGrid.appendChild(tabLabel);
        }
        
        // Clone the card for search results and ensure proper styling
        const clonedCard = item.card.cloneNode(true);
        
        // Ensure the cloned card has proper styling and structure
        clonedCard.style.display = 'block';
        clonedCard.style.breakInside = 'avoid';
        clonedCard.style.pageBreakInside = 'avoid';
        
        // Remove any potential display:none that might have been set
        const clonedContent = clonedCard.querySelector('.tool-content');
        if (clonedContent) {
          clonedContent.style.display = 'flex';
        }
        
        searchGrid.appendChild(clonedCard);
      });
    } else {
      // No results found
      searchContainer.style.display = 'none';
    }
  });
}

// Return to Top button
const returnTopBtn = document.getElementById('returnTopBtn');
window.addEventListener('scroll', function() {
    if (window.scrollY > 300) {
        returnTopBtn.classList.add('visible');
    } else {
        returnTopBtn.classList.remove('visible');
    }
});

returnTopBtn.addEventListener('click', function() {
    window.scrollTo({ top: 0, behavior: 'smooth' });
});
    </script>

</body>
</html>